* synchronicity
  + waiting on all getImageMeta/metric pos to complete
    + before re-resing all
      + before updating
  + ideally want things to only aggregate at highest level
    + so that each thread can keep the pipefull

* refactor eventContext stuff
  + I'm not going to want to do it
    + but go back in, test alternatives and clean-up eventContext stuff
    + there are too many unanswered questions
      + and I'm sure I can make the syntax easier
  + started already
    + straight deferreds are the way to go
      + maybe just use eventQueue to handle the link between fire_ and handler_
  + question: how do we handle events we're trying to nullify
    + search 'replaceEvent'
      + refreshSelected / imageAdvanceTo 
  + question: should we sometimes resolve deferreds only after the handler fires?
    + like
      + fire_scrollUpdate
      + refreshSelected / imageAdvanceTo 
    + risky?
      + maybe
  + some contexts contain deferreds that are getting resolved
    + but the eventContext never gets removed from the eventQueue
      + while it's there it could potentially interfere with other queued eventContexts
      + need to remove them
        + try and use the eventQueue to resolve
          + because then the resolve can also remove from the queue
        + that requires that events can identify themselves to the queue
          + and say 'delete me'
        + best place to handle that is in hashTable
          + which means moving evid (eventQueue) to id (hashTable)
  + unfilled get requests are fine most of the time
    + they don't accumulate which is great
  + having some issues getting events to resolve all the way down the chain
    + try from api_ call and work backwards
      == carry on with this!

* thinking about maximising the space
  + could swap an image +/-1 to get it to the top of a column
  + landscape
    + could expand the width of a cell
    + could decrease the height of a cell
  + portrait
    + could expand the height of a cell
    + could decrease the width of a cell

* end, fullscreen, home
  + check re-res

* extend test suite
  + test reres
    + end
  + need to connect the deferred in the hash handler to some kind of external/api
    + pushing a value in the URL might be an option
      + but that only extends to hash values
      + nice to come up with something global
        + need to find a way to push identifiers through the event chain
          + e.g. x in scrollUpdate(x) -> handler_scrolled(x)
--o--
* wire in deferreds through everything else
  + make it work for handler_hash first

* page up should eventually move the selection to 0
  + page down should eventually move to end

* extend test suite
  + test reres
    + mouse wheel two images right

* extend test suite
  + test imgmetric vis

* optimise dragging in large image sets

* on a direction change
  + show semi-opaque numbers in circles over each image
    + to reflect order of images

* .s in directory names, like mq

* imagemeta/ endpoint should always get image metadata
  + at the moment it only produces good metadata for pre-cached images
    + if we discover an image uncached
      + we should cache it at standard thumbnail size (longest edge 200)
        + most cache requests comes in 

* mousewheel after scroll needs to re-align
  + otherwise can be scrolling in half-images

* treat direction as another piece of hash state
  + where a hash value is the same as
    + NOT what's in document 
      + because it changes
    + the default value from the last page load

* res change needs to fresh metric positions
  + could tie that into refreshCells

* accelerate scroll catch-up
  + working but needs to be quicker
  + may need new async/promise trick

* need to get an alpha online
  + doesn't need to be a big release, but it does have to be a first release

--- post first launch ---

* imgmetric as mini bar chart
  + show percentage in background too
    + visually reinforce when you're looking at massive images (small)

* page up/down should advance to next image that partially off screen

* vertical mode needs work
  + catch up js with horizontal
    + should work properly in test suite too

* show video entries in directory thumbnails

* show imgmetric on videos

* single entry in folder
  + or fewer entries that a single column
  + align left, not centre
    + which will mean it doesn't matter if we turn off border-left

* never show thumbnails on mediacache

* shuffle directories to top
  + like in windows

* introduce HTML for markers
  + directories/images/files
  + but don't worry too much about what markers we insert to start with

* shuffle non-image files to bottom
  + just for convenience

* test using app.php for everything
  + is it possible to make elan an exception (and use app_dev.php)

* think about javascript changing cell percentage based on mean row height/column width
  + alternative is dynamically reducing column cell widths, column by column
    + alternative is better I think

* cookie header options
  + to remember what we were looking at
  + think about hash-bang/url change too

* safari sometimes-sometimes-not resizing images
  + see iPad

* folders maintain square aspect in landscape cells
  + make x-bound
    + write javascript to detect div.folder width and flip class
    + write y-bound class specifically for div.folder

* Redraw folders at 1440x1080
  + 4:3

* Add ../ up arrow to directory listings
* create file icon

* Nice looking header icon (sf in circle with chunk bitten out)
* Rotate header icon on rollover header expand

* Horizontal/verical icon
* Light/dark icon

* snameed jQueryUI scroller for number of images wide/high

* Fail nicely when a file/directory/path element doesn't exist

* Using Project sheet in Google drive for major functional items
https://docs.google.com/a/lightenna.com/spreadsheet/ccc?key=0AuXNj3kHNsfddFhwTGZpcERMd1JweTVuMEFoS3h6YUE&usp=drive_web#gid=0










































Done
----

* setup paths bin

* install composer

* use composer to install symfony2

# install composer into bin directory using downloaded install script
php bin\install-composer.php --install-dir bin

* create a project
php -c conf bin\composer.phar create-project symfony/framework-standard-edition ./vendor/symfony2/ 

* commit everything to an open repo

* test basic route on prod

* create directory indexer like before
  + but under symfony

* setup php-dev server for dev if caching is annoying
  = didn't have to, configured normal apache to use app-dev

* setup model for record(directoryEntry)

* setup controller and route

* setup directory, file and record->directory->zip

* never add trailing / to directories
  + and make thumbnail paths work using linkpath

* Double data/ for directories with trailing /
  + http://localhost:8080/file/data/

* Images not showing from zips

* Error image

* no route found for /file

* double // for /file/ or /file

* 404 for for / or <blank>

* write test function for jazzy new performFilenameSubstitution()
  + extend to cover zips

* clipping bug when used *with* resize
  + suspect it's to do with not resetting width and height
    + better to re-read

* Write tests for image resize/clip

* Internal server error on really big image requests
  + if requested size is greater than image, just return image
  + http://sfun.elan/image/data/alice%20eve.zip/alice%20eve/alice-eve-06.jpg~args&thumb=true&maxwidth=4250

* Add FileReader, then MetadataFileReader, then CachingMetadataFileReader
  + but only after we've made the current read work
    + unless we're refactoring in the wrong direction

* Make test suite work for ViewController URL transformations plus new FileReader ones
  + sort of, ok for now

* Rewrite ViewController to use FileReader

* Make Fileview work using FileReader family classes

* Try getListing on single file
  + should just return that file

* Fix zip_part being given all the args

* Make Imageview work using FileReader family

* Weed out old tests

* Deprecate old ViewController code as using FileReader instead

* Double appending filename to end of video in stats->file

* Get cache working for video

* Need to make mediacache directory for -linux install and enable for selinux

* ../ bug in splitFilePath

* write more tests for FileReader
  + crop child as well as crop parent within zip
  + e.g. http://sfun.elan/file/data/alice%20eve.zip/ is wrong

* add super-short video to test suite

* handle large images sanely

* add test to check that two different timecodes produce two different frames
  + and same timecode produces identical frame

* fix missing video thumbnails
  + it's SELinux

* add support for .png
  + process png as png, not jpeg

* mfr bug for test suite
  + whenever we open a zip
    + stats->file is the zip folder name
    + stats->name is the file name

* Nested folders in zips should be links
  + then think about collapsing

* factor out CacheHelper

* Reading all the files for resolution/shape is too slow
  + introduce caching by default

* Javascript resolution check and class apply
  + x-bound and y-bound
    + have temporarily disabled cache to apply this
logic check
cr/ir
portrait container 200x300 ratio = 2/3 = 0.66
wide image = 300x200 ratio = 3/2 = 1.5
bound, 0.66/1.5 = 0.4 = <=1 = x

portrait image = 200x300 ratio = 2/3 = 0.66
bound, 0.66/0.66 = 1.0 = <=1 = x

v-portrait container 150x300 ratio = 1.5/3 = 0.5
bound, 0.66/0.5 = 1.33 = >1 = y

v-wide container 400x200 ratio = 4/2 = 2.0
wide image = 300x200 ratio = 3/2 = 1.33
bound, 2.0/1.33 = 1.66 = >1 = y

square image = 200x200 ratio = 2/2 = 1.0
bound, 2.0/1.0 = 2.0 = >1 = y

portrait image = 100x200 ratio = 0.5
bound, 2.0/0.5 = 4.0 = >1 = y

* not 100% on mini-pictures in folder
  + probably 20%

* folder image and overlay
  + small image alignment

* 100% height on directory background
  + if that's possible

* send out transparent gif/png for missing previews

* strange thumbnail zooming thing
  + thumbnails getting big and blurry
    + because the point we store back to the cache is after cropping
    + change mfr->cache() call point or add clipwidth/height to cache keys

* every page is too high
  + being given a redundant vertical scollbar
    + try making Symfony use production version

* image vertical centering

* back to directory view doesn't bound images properly
-- same as --
* javascript image classes failing
  + works on refresh, but not always on first load
    + disable caching to debug
      + doesn't happen reliably, needs more investigation

* javascript re-assess x-bound or y-bound on resize

* tweak sfac on js y->x scrolling

* set screen-x/y as percennamee
  + covers pre-update scenario to fix quirky drags
* check chrome re-bound

* mac dragging around the edge messes up sideways scroll
  = solved by stopping bubble

* Either move $this->stats down to MetadataFileReader
  + or rename as AwareFileReader
  = refactored, much neater now

* Convert args to object

* Don't cache error img
  + test suite failing because error image comparison fails

* Repeated vertical (flow-y) resize toggles between rows
  + slightly funny stuff going on
    + jitters between 2 and 3 rows
    ? could be finding a % in the id because we set one?
  + test drag behaviours
  = not perfect, but good enough

* Windows test suite errors

* Re-do folder from ai to produce authoritative psd
  = not psd, but exported from ai

* Debug image
  + turns out to be a artefact of an image -> in a zip -> in a shared folder
    + equally only applies to thumbnails (which is very strange)

* Create a test share and mount it into the structured tests directory
  + that way it should never affect users
    + and can provide that

* Folders on dark background

* Folders (part 1) maintain square aspect in landscape cells
  + fix positioning

* Fix nasty selection bug
  = test, done I think

* Producing two cache entries for a single image
  + don't save to cache if this image was loaded from the cache
    + ah ha, might be already protected for that
    - mmm, not
  = fixed by ensuring that we don't always generate a new cache key
    + which isn't necessary when rewriting from the cache

* Cachekey not set for directory listing
  + except first entry
  + cache is being used for all the images
    + but for some reason their cachekey isn't making it into the directory listing
    + that may not be a problem, but worth investigating
  + this is true for both zips and normal directory listings
    + it means we're not finding cached entries
      + which in turn means we never fetch metadata for dir entries
  + actually weren't putting any cachekeys in
    + trick is to use the right cache key
      + always the one for the file in situ, not in the cache
  + right, now we're getting different cachekeys because
    1. actually image is a restricted thumbnail, so uses args
    2. is just an image path, so has no args
    + verify that's true

* Clean up metadata that gets stored in cache files
  + don't need all the spurious stuff
  + rewrite names
    + width_original
    + height_original

* Think of a way to store data-native-width and data-native-height in the cached image metadata
  + worth finding ways to store and retreive image metadata anyway
    + plus it enables re-res
  + start with cache function
    + write in native-width/height
* Use cached data to write native width/height into data fields

* Round newwidth/height

* Fix test suite errors

* write getFilename and getFullname tests for test suite
  + important to have a record somewhere of what these functions should return

* video thumbnails need metadata too

* bug
probably caused by
http://sfun.elan/image/data/alice%20eve.zip/alice%20eve/alice-eve-jiggle-ibbZy7SI8fCxXB.gif~args&thumb=true&maxlongest=200&
http://sfun.elan/file/data/alice%20eve.zip/alice%20eve/
getimagesize(): Read error! in /var/www/git/github.com/structuredfun-linux/structured/htdocs/src/Lightenna/StructuredBundle/DependencyInjection/CachedMetadataFileReader.php on line 194 
+ cache is producing bad gif
  + need to make it produce a gif, but a wrapped jpg

* test out showing display-size in imgmetric in js
  + then come back to html

* get relative position of image within parent container
  + then apply to imgmetric
    + parent container is shared parent of both img and imgmetric
  = did using absolute coords
    - relative (using jquery.position() instead of offset) doesn't put it anywhere close

* bug: imagemeta is requested for each image twice
  + look at Firebug Net tab

* bug: imagemeta doesn't request images at right (bigger) size
  + got to sort of pass waitForLoad right through the chain

* use js to re-write all image URLs to local hashbangs
  + indirect via a handler rather than rewrite

* right-arrow, down-arrow
  + go one frame right

* click goes to flow-1
  + and jumps to that image

* firefox scaling factor
  + for scroll-x

* re-res directory thumbnails as per normal images
  = decided not to re-res for jq load
    + but have improved res to 200px

* title on folders

* get state in one place
  + URL: breadth, image seq, direction
    + fall back to HTML if not set
  + make nice functions that cascade
  ? do we want to cache in javascript?
    ? could this be a good time to embed a framework?

* back to page without explicit breadth
  + needs default

* clicking on an image pushes state
  + but it should only do that if the URL is different
  + otherwise the history queues up with duplicate entries
    + which makes 'back' confusing

* imageAdvance crashes browser

* need to detect if next/previous pushes us on to a new page
  + e.g. always for 1 up
  + only scrollTo() if advancing to new page

* scrollTo breaks click
  + advance to a high image
  + go fullscreen
  + advance a few more (to about 3rd or 4th)
  + go back to b2
    + think this is just like the upper end crop

* 1 minor bug in linux test suite
  + also just 1 (same 1) in windows

* reduce apache to 2 concurrent threads
  + should never use more than 2 cores
    + see if that helps with the responsiveness of the page
      - otherwise may need to use blank images
  + working for windows
    + not going to apply to linux config because we don't have the same whole-app

* time for a front-end test suite
  + introduce a basic QUnit
  + introduce a #test
    + as a new button for the header in its own file
  = half way through this
    + press on with mustache template

* return jumps back to previous image
  + but doesn't always go back to
  + seems to work ok
    + will revive if I can replicate again

* arrows get stuck sometimes
  + seems like history.js is playing up
    + get strange behaviour with advance (+/-) where it won't go one direction

* advance should wrap around

* after a click, need to focus on an element so we get keypresses
  + try jquery focus
    - it's not a focus
    + left and right arrows work, but return does not
    = just needed a preventDefault to stop the return triggering a URL refresh

* ctrl+home/ctrl+end

* scrolling needs to advance seq selection to the right image
  + important because we can't use page up/down or arrow keys after scrolling

* resize (refreshCells) event in Chrome
  + creating a new image and then measuring its width and height doesn't work
    + ix = iy = 0
  + solved by using an onload

* probably need to invest time in the javascript test suite
  + I keep exposing stuff that doesn't work on my non-test browser
    + once I've started it will flow
    = got something started

* only swap out visible images
  + swapping them all is too intensive
    + probably should try to avoid going over about 50 x 1000
      + add as line in config file
  + made progress on this
    + may return to it

* checkBound is now async
  + we need to do all the async stuff before trying to do the sync stuff
    + build a loaded image size map on image reload
    + build a cell size map on window resize
  + it's another level of complexity
    + it means we're partly reliant on the DOM, partly on js proxy objects
  + this is important
    + we need to get some kind of promise setup

* work on page load speed
  + currently reloading all images (from cache) on every checkImageBounds
    + solved using test

* first load (uncached) makes a mess of image bounds
  + it's because we've not got a loaded-width/height

* imgmetric scattered all over the page after switching from b=2 to b=1
  = ok for now
* current loading 250s en route to loading 500s
  + suspect it's to do with image bounds
  = ok for now

* extra scollbar, bit too much margin somewhere
  http://10.12.1.160:8097/file/data/alice%20eve.zip/alice%20eve/

* protect handler_scroll from itself
  - I think it's getting stuck searching for img.visible when there aren't any
* handler_scroll shouldn't be called when the page loads

* need to add scroll handler
  + at the moment we trap against mousewheel
    + but it's possible to drag the scrollbar

* setVisibleByScroll
  + tricky
    + can't quite decide if it should just scroll and
      + let the scroll handler sort out all the image
    + I think yes

* sort of moving everything out of init() now
  + and triggering hash change instead

* something is triggering a scroll event to 0,0
  + happens during page load
  + e.g. http://10.12.1.120:8097/file/structured/tests/data/20-image_folder/#breadth=2&seq=9
  + may not actually be resolvable
  = have inserted a jump-back using ignored scroll:0,0 event

* change out all the clicks to be hash changes
  = done most of them

* change image seq to entity seq
  + we want to be able to select folders
  + throws error on 
    + http://10.12.1.120:8097/file/playspace
  + because directory features in middle of images
  = not without issues but working pretty well

* change cache file extension into .dat
  + avoid mediacache leak

* test suite error
  + only occurs when running a second time
  + it's a cache error
  + need to keep hold of the original extension

* first load after cache clear
  + not reresing images
  + seems like we're not waiting for image load before firing imagemeta request

*** have set a cache clear every run! ***
  + but only from my local settings

* need to be able to merge in settings from config files

* could be double-loading the metadata
  + would explain why we're swapping out the images twice

* NaN% on certain images
  + there's an ordering of concurrent ops that allows this
  + problem is that the image is loaded
    - but the imagemeta call hasn't returned yet
    + so we're trying to compute %age based on width/height-native
    + but they don't exist yet
  = have protected
    + watch for images not re-resing

* double end doesn't work
  + seems to only be in larger datasets
    + this happens when we end up with no .visible entries
      + we do a select on a jqEnt that doesn't exist
        + protect against that
      + then fix the forward

* right arrow from sMAXb1
  + should wrap around to show s0b1
  - but get error

* Apache builds for Windows
  + http://www.apachelounge.com/download/additional/

* don't load all thumbnails in very large data sets
  + still quite slow on load
    + think js op is slow
  + also doesn't work
  + need to do it the lazy loading way
    + http://www.appelsiini.net/projects/lazyload
    + start by implementing noscript version
  = working, may need to do more

* dragging in very large image set
  - jumps back to zero every drag

* key press (like ctrl+end/home) triggers hash change
  + hash change loses key focus from window
    + need to preserve so we can 
  = seems to be working for now

* fullscreen from visible images
  + needs to refreshImage

* images not displaying
  + problem doesn't seem to be caused by the refactoring
  + the cells are slightly outside the window (top:-1, left:-1)

* move selectable, selected, visible up to cell
  + test thoroughly

* clean up isVis to make it reliable for on-screen

* fix end bug

* fix test suite
  + end doesn't select last entry
    + it's toggling between 838 and 836
    + which I think is caused by isVis getting it wrong
      + test using #!seq=8
    + do it properly with unit tests
      + tricky to test
    + best to do it with the test suite

* extend test suite
  + test visibility
    + scroll to start, scroll to end, scroll to middle
    + test all visibles in one block (no littering)

* extend test suite
  + test reres
    + reres of first x images

* need to work out how to handle tests keyed upon delayed events
  + deferred promises are the way
    - but passing them around is tricky
  + either parent thing can make a queue
    + and pass it to all the sub functions
  + or originate in each sub function
    + and then aggregate queues in parent functions
  = brilliant piece on deferred patterns
    http://blog.mediumequalsmessage.com/promise-deferred-objects-in-javascript-pt2-practical-use

* fullscreen of image 0 needs to hide all imgmetrics

* fullscreen/return should toggle
  + between b1 and bPrevious

* changing from b2 to b1
  + need to do another refreshCells at least on current image
    + because cell shape may have changed dramatically

* reload page from final entry doesn't swap out images properly
  + seems not to be loading thumbnails
    + so the 500 request doesn't get any metadata

* arrow-key / home after scroll

* pull forward UI test suite

* rewrite isVisible function to cope with partials
  + frequently images are partly on screen
    + but not treated as visible

* dropping back from fullscreen, checkImageRes swaps out all the images
  + not just the visible ones
    + this is all to do with async stuff
    + we need to wait for the hash updates to complete before doing a checkimg

* not loading right image just in time
  + in fullscreen mode
    + loading one image behind

* this test suite stuff is so important
  + I've just recovered from breaking it
    + a break that wouldn't have occurred if I had a reliable test suite
    + and could have been hunting for regressions all the time!

* re-write hashTable using Object.create
  + put in separate file for now
    + can aggregate later
  = thought better of
    + not enough instantiation to merit prototypes


* force imagemeta to return meta

* modify the numbEventQueue to be deferreds manager
    + that's a pretty good handler
    + needs a hash (string), done function pointer and parent
  + looking pretty good
    + need to find a way to pass deferreds through the eventQueue
      + will circle back to this once we've got deferred cascading through the actual event handlers
* expose deferred through exported API
  + need to create deferred first
    + then pass into following event handlers
  + so we can queue up dependent functions
    + like the test functions
  + we get into complications when we're trying to push a deferred through a hash update
    + there are potentially many layers
      + one hash update, triggers scroll update, triggers hash update
      + nice to great some kind of general rule
  + how about eventQueue for storing the deferred
    + create when eventQueue item created
    + pick it up in the handler
      + could even link up parent events
        + done when say setScrollPosition called indirectly by a handler
  + maybe it's a combination metaphor
    + we need eventQueue to bridge between code->handler
      + because it's async
    + how to do parenting
      + class-wide var is complicated because it could get messed up
        + it's analogous to the old-school global variable
      + passing deferred from function to function requires care
        + it's going to need elaborate lacing together
        + could pass event object around
  + making eventQueue fairly smart
    + tries to wrap up as much of the promise logic as possible
      + because then it's all in one place
        + if a 'parent' set it does get resolved once its child is resolved
  - beginning to wonder if the necessary deferred tree will be just too complicated
    + it reaches through almost everything
      + might need to rewrite most ops as synchronous
    + not sure
    + using the #hash is elegant
  + eventContext originators
    + fire_
  + eventContext decorators/ornaments
    + everything else
  + eventContext resolvers
    + terminals that create a local context and resolve
  + execution summary
    To numb a listener, at the point we decide to numb it
      eventQueue.pushChild(eventContext, { 'replaceEvent': function(){} })
    To pass a context on, which may have been numbed upstream
      eventContext
  + what about passing
    + everything we pass it into
      + needs to be able to pass it out?
  + check the event story
    + fire_scrollUpdate creates eventContext(1)
    + handler_scrolled receives eventContext(1)
      + calls refreshVisibility with same context(1)
        + refreshVisibility doesn't do anything async itself, so no forking
        + calls setVisibleAll with eventContext(1)
          + calls setVisibleImage with eventContext(1)
            + calls refreshImage with eventContext(1)
              + calls refreshBounds with eventContext(1)
                + calls getLoadedResolution with eventContext(1)
                  + creates it's own child eventContext(2) using pushChild
                    + sets up stuff to happen
                    + returns eventContext(2) so that parents can queue up other stuff for AFTER this happens
                    + when stuff happens the child resolves (eventContext(2) resolves)
                    + the things that the parent queued up start getting executed
                  + returns eventContext(2) if it scheduled stuff, or eventContext(1) if it didn't
                + refreshBounds then queues stuff against the eventContext it receives (2/1)
              + refreshImage then queues stuff against the eventContext it receives
  + remember
    + pushChild only when we're about to WAIT for something to happen (e.g. an actual async wait, e.g. image load)
    + .then to setup things to happen in sequence
    + can normally chain execution with .then()
      + only need to create a new context when
        + waiting on something unpredictable
        + OR MAYBE when doing multiple things
  - not sure about pushChild needing to 'resolve' the parent
    + think it's probably a yes
  - not sure about how to execute multiple things in sequence
  + not currently preserving eventContext across checkMetadata
    + that a bit is deliberately async-unsync
  + everything is stacking up on the eventQueue
    + seem to be resolving <unset:2> several times over
      + could be because 2 is everything's parent
  + problem is that we're stacking all the eventContexts in series
    + there are some that are event dependent
      + which means they can resolve at any time
        + which means the middle of the chain resolves
    + need to create contexts for each event-dependent event
      + then do some kind of aggregation to say 'wait for them all to finish'
    + eventContext:parent is used to kick the parent
    + eventContext:deps is used to store a list of all the contexts we depend on
      + everytime the parent gets kicked
        + it checks to see if all the deps have been satisfied
    + if there are no deps
      + it resolves right away
    + I get foggy on the different situations this can come up in
      1. do something in a child function, when it's done, allow its parent to be called
      2. ? is there a 2?

* add class nearvis
  + add to it 2x breadth on either side nearvis

* look over remaining eventContext vars

* need to expire unmatched scroll events
  + mouse wheel produces lots of scroll events
    + they hang around in the queue indefinitely
    + could expire after 1 second
      + because the gap between scroll and handler shouldn't be more than that

* think about buffering scroll events
  + handler_scroll
    buffer (function(){}, 50)
    + could return using a deferred
      + like a deferred, simple
        + but we have to be careful because 
          + there could be queued eventContexts interleaved with random scroll events
          + each one of those eventContexts needs to get dealt with
    + could return doing something clever with the invented context
      + could pushChild each context
        + so that once we complete the last one
        + we also complete all the others

* rebound/x-bound on 305 at fullscreen

* only show imgmetric when image has re-res'd

