
* write getFilename and getFullname tests for test suite
  + important to have a record somewhere of what these functions should return

* video thumbnails need metadata too

--

* Folders maintain square aspect in landscape cells
  + make x-bound
    + write javascript to detect div.folder width and flip class
    + write y-bound class specifically for div.folder

* Folders need proper title overlay
  + correctly positioned
* Extra scollbar, git too much margin somewhere
  + seems to be a function of folders

* Redraw folders at 1440x1080
  + 4:3

* Add ../ up arrow to directory listings
* create file icon

* Nice looking header icon (sf in circle with chunk bitten out)
* Rotate header icon on rollover header expand

* Horizontal/verical icon
* Light/dark icon

* snameed jQueryUI scroller for number of images wide/high

* Fail nicely when a file/directory/path element doesn't exist

* Using Project sheet in Google drive for major functional items
https://docs.google.com/a/lightenna.com/spreadsheet/ccc?key=0AuXNj3kHNsfddFhwTGZpcERMd1JweTVuMEFoS3h6YUE&usp=drive_web#gid=0



Done
----

* setup paths bin

* install composer

* use composer to install symfony2

# install composer into bin directory using downloaded install script
php bin\install-composer.php --install-dir bin

* create a project
php -c conf bin\composer.phar create-project symfony/framework-standard-edition ./vendor/symfony2/ 

* commit everything to an open repo

* test basic route on prod

* create directory indexer like before
  + but under symfony

* setup php-dev server for dev if caching is annoying
  = didn't have to, configured normal apache to use app-dev

* setup model for record(directoryEntry)

* setup controller and route

* setup directory, file and record->directory->zip

* never add trailing / to directories
  + and make thumbnail paths work using linkpath

* Double data/ for directories with trailing /
  + http://localhost:8080/file/data/

* Images not showing from zips

* Error image

* no route found for /file

* double // for /file/ or /file

* 404 for for / or <blank>

* write test function for jazzy new performFilenameSubstitution()
  + extend to cover zips

* clipping bug when used *with* resize
  + suspect it's to do with not resetting width and height
    + better to re-read

* Write tests for image resize/clip

* Internal server error on really big image requests
  + if requested size is greater than image, just return image
  + http://sfun.elan/image/data/alice%20eve.zip/alice%20eve/alice-eve-06.jpg~args&thumb=true&maxwidth=4250

* Add FileReader, then MetadataFileReader, then CachingMetadataFileReader
  + but only after we've made the current read work
    + unless we're refactoring in the wrong direction

* Make test suite work for ViewController URL transformations plus new FileReader ones
  + sort of, ok for now

* Rewrite ViewController to use FileReader

* Make Fileview work using FileReader family classes

* Try getListing on single file
  + should just return that file

* Fix zip_part being given all the args

* Make Imageview work using FileReader family

* Weed out old tests

* Deprecate old ViewController code as using FileReader instead

* Double appending filename to end of video in stats->file

* Get cache working for video

* Need to make mediacache directory for -linux install and enable for selinux

* ../ bug in splitFilePath

* write more tests for FileReader
  + crop child as well as crop parent within zip
  + e.g. http://sfun.elan/file/data/alice%20eve.zip/ is wrong

* add super-short video to test suite

* handle large images sanely

* add test to check that two different timecodes produce two different frames
  + and same timecode produces identical frame

* fix missing video thumbnails
  + it's SELinux

* add support for .png
  + process png as png, not jpeg

* mfr bug for test suite
  + whenever we open a zip
    + stats->file is the zip folder name
    + stats->name is the file name

* Nested folders in zips should be links
  + then think about collapsing

* factor out CacheHelper

* Reading all the files for resolution/shape is too slow
  + introduce caching by default

* Javascript resolution check and class apply
  + x-bound and y-bound
    + have temporarily disabled cache to apply this
logic check
cr/ir
portrait container 200x300 ratio = 2/3 = 0.66
wide image = 300x200 ratio = 3/2 = 1.5
bound, 0.66/1.5 = 0.4 = <=1 = x

portrait image = 200x300 ratio = 2/3 = 0.66
bound, 0.66/0.66 = 1.0 = <=1 = x

v-portrait container 150x300 ratio = 1.5/3 = 0.5
bound, 0.66/0.5 = 1.33 = >1 = y

v-wide container 400x200 ratio = 4/2 = 2.0
wide image = 300x200 ratio = 3/2 = 1.33
bound, 2.0/1.33 = 1.66 = >1 = y

square image = 200x200 ratio = 2/2 = 1.0
bound, 2.0/1.0 = 2.0 = >1 = y

portrait image = 100x200 ratio = 0.5
bound, 2.0/0.5 = 4.0 = >1 = y

* not 100% on mini-pictures in folder
  + probably 20%

* folder image and overlay
  + small image alignment

* 100% height on directory background
  + if that's possible

* send out transparent gif/png for missing previews

* strange thumbnail zooming thing
  + thumbnails getting big and blurry
    + because the point we store back to the cache is after cropping
    + change mfr->cache() call point or add clipwidth/height to cache keys

* every page is too high
  + being given a redundant vertical scollbar
    + try making Symfony use production version

* image vertical centering

* back to directory view doesn't bound images properly
-- same as --
* javascript image classes failing
  + works on refresh, but not always on first load
    + disable caching to debug
      + doesn't happen reliably, needs more investigation

* javascript re-assess x-bound or y-bound on resize

* tweak sfac on js y->x scrolling

* set screen-x/y as percennamee
  + covers pre-update scenario to fix quirky drags
* check chrome re-bound

* mac dragging around the edge messes up sideways scroll
  = solved by stopping bubble

* Either move $this->stats down to MetadataFileReader
  + or rename as AwareFileReader
  = refactored, much neater now

* Convert args to object

* Don't cache error img
  + test suite failing because error image comparison fails

* Repeated vertical (flow-y) resize toggles between rows
  + slightly funny stuff going on
    + jitters between 2 and 3 rows
    ? could be finding a % in the id because we set one?
  + test drag behaviours
  = not perfect, but good enough

* Windows test suite errors

* Re-do folder from ai to produce authoritative psd
  = not psd, but exported from ai

* Debug image
  + turns out to be a artefact of an image -> in a zip -> in a shared folder
    + equally only applies to thumbnails (which is very strange)

* Create a test share and mount it into the structured tests directory
  + that way it should never affect users
    + and can provide that

* Folders on dark background

* Folders (part 1) maintain square aspect in landscape cells
  + fix positioning

* Fix nasty selection bug
  = test, done I think

* Producing two cache entries for a single image
  + don't save to cache if this image was loaded from the cache
    + ah ha, might be already protected for that
    - mmm, not
  = fixed by ensuring that we don't always generate a new cache key
    + which isn't necessary when rewriting from the cache

* Cachekey not set for directory listing
  + except first entry
  + cache is being used for all the images
    + but for some reason their cachekey isn't making it into the directory listing
    + that may not be a problem, but worth investigating
  + this is true for both zips and normal directory listings
    + it means we're not finding cached entries
      + which in turn means we never fetch metadata for dir entries
  + actually weren't putting any cachekeys in
    + trick is to use the right cache key
      + always the one for the file in situ, not in the cache
  + right, now we're getting different cachekeys because
    1. actually image is a restricted thumbnail, so uses args
    2. is just an image path, so has no args
    + verify that's true

* Clean up metadata that gets stored in cache files
  + don't need all the spurious stuff
  + rewrite names
    + width_original
    + height_original

* Think of a way to store data-native-width and data-native-height in the cached image metadata
  + worth finding ways to store and retreive image metadata anyway
    + plus it enables re-res
  + start with cache function
    + write in native-width/height
* Use cached data to write native width/height into data fields

* Round newwidth/height

* Fix test suite errors

